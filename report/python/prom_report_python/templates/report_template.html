<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <title>æ¯æ—¥ç›‘æ§æŠ¥å‘Š</title>
<style>
    @page { size: A4; margin: 2cm; }
    body { 
        font-family: "SimSun", "Microsoft YaHei", "Noto Sans CJK SC", "WenQuanYi Zen Hei", "PingFang SC", Arial, sans-serif; 
        color: #333; 
        line-height: 1.8; 
        font-size: 11pt;
    }
    h1 { 
        text-align: center; 
        color: #1e3a8a; 
        font-size: 24pt; 
        margin-bottom: 10px;
        font-weight: bold;
    }
    h2 { 
        color: #1d4ed8; 
        font-size: 16pt; 
        border-left: 6px solid #3b82f6; 
        padding-left: 12px; 
        margin-top: 40px;
        font-weight: bold;
    }
    table { 
        width: 100%; 
        border-collapse: collapse; 
        margin: 25px 0; 
        box-shadow: 0 4px 12px rgba(0,0,0,0.1); 
        font-size: 10pt;
    }
    th { 
        background-color: #3b82f6; 
        color: white; 
        padding: 14px; 
        font-weight: bold;
    }
    td { 
        padding: 12px; 
        text-align: center; 
        border: 1px solid #e5e7eb;
    }
    .alert { 
        background-color: #fee2e2 !important; 
        color: #991b1b; 
        font-weight: bold; 
    }
    .chart-title { 
        font-size: 14pt; 
        font-weight: bold; 
        color: #1e40af; 
        text-align: center; 
        margin: 40px 0 15px 0; 
    }
    .alert-title { 
        color: #dc2626 !important; 
    }
    img { 
        max-width: 100%; 
        height: auto; 
        display: block; 
        margin: 20px auto; 
        border: 2px solid #e0e0e0; 
        border-radius: 10px; 
        box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }
    .footer { 
        text-align: center; 
        margin-top: 60px; 
        color: #6b7280; 
        font-size: 9pt; 
        border-top: 1px solid #e5e7eb; 
        padding-top: 20px;
    }
</style>
</head>
<body>
    <h1>æ¯æ—¥ç›‘æ§æŠ¥å‘Š</h1>
    <p style="text-align:center; font-size:12pt; color:#4b5563;">æŠ¥å‘Šå‘¨æœŸï¼š{{ date }}ï¼ˆ{{ start }} è‡³ {{ end }}ï¼‰</p>
    
    <h2>ä¸€ã€æŒ‡æ ‡æ±‡æ€»</h2>
    <table>
        <tr><th>æŒ‡æ ‡åç§°</th><th>å½“æ—¥å¹³å‡å€¼</th><th>é˜ˆå€¼</th><th>å•ä½</th><th>å¥åº·çŠ¶æ€</th></tr>
        {% for item in metrics %}
        <tr class="{{ item.state }}">
            <td><strong>{{ item.name }}</strong></td>
            <td>{{ "%.2f" % item.avg }}</td>
            <td>{{ item.threshold }}</td>
            <td>{{ item.unit }}</td>
            <td>
                {% if item.state == 'alert' %}
                <span style="color:#dc2626; font-weight:bold;">âš ï¸ è¶…è¿‡é˜ˆå€¼ï¼</span>
                {% else %}
                <span style="color:#16a34a;">âœ”ï¸ æ­£å¸¸</span>
                {% endif %}
            </td>
        </tr>
        {% endfor %}
    </table>
    
    <h2>äºŒã€è¶‹åŠ¿å›¾è¡¨</h2>
    {% for item in metrics %}
        {% if item.chart %}
        <div class="chart-title {% if item.state == 'alert' %}alert-title{% endif %}">{{ item.name }} è¶‹åŠ¿å›¾</div>
        <img src="data:image/png;base64,{{ item.chart }}" alt="{{ item.name }}">
        {% endif %}
    {% endfor %}
    
    <h2>ä¸‰ã€å½“å‰æ´»è·ƒå‘Šè­¦</h2>
    {% if alerts %}
    <table>
        <tr><th>å‘Šè­¦åç§°</th><th>ä¸¥é‡åº¦</th><th>æè¿°</th></tr>
        {% for a in alerts %}
        <tr class="alert">
            <td><strong>{{ a.name }}</strong></td>
            <td><span style="color:#dc2626;">{{ a.severity }}</span></td>
            <td>{{ a.description }}</td>
        </tr>
        {% endfor %}
    </table>
    {% else %}
    <p style="text-align:center; color:#16a34a; font-size:14pt; font-weight:bold;">ğŸ‰ æ— æ´»è·ƒå‘Šè­¦ï¼Œç³»ç»Ÿè¿è¡Œå¥åº·ï¼</p>
    {% endif %}
    
    <div class="footer">
        <p>è‡ªåŠ¨ç”ŸæˆæŠ¥å‘Š Â· Prometheus ç›‘æ§ç³»ç»Ÿ Â· {{ date }}</p>
    </div>
</body>
</html>
